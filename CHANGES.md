# 変更履歴

## 実装済みの変更

### 1. 総合練習の値変更 ✅
- 変更前: pass: 0.5, dribble: 0.5, shoot: 0.5 (合計1.5)
- 変更後: pass: 0.9, dribble: 0.7, shoot: 0.7 (合計2.3)

### 2. 休養ペナルティシステム ✅
- 説明文変更: 「次の試合で全能力+2 ただし、次の日には2.1下がる」
- 実装: 試合後に自動的に2.1下がる機能を追加
- 最低値保証: 能力値は1以下にならない

### 3. キャプテン情報表示の簡略化 ✅
- 変更前: 「性格: パワハラ (説明文)」
- 変更後: 「性格：パワハラ　方針：論理的」

### 4. ハンドボールポジションシステム ✅
- 7つのポジションを実装: LW, RW, CB, LB, RB, P, GK
- 参考: https://matsusakaaaano.com/handball/wp-content/uploads/2021/01/handoball-pojisyon.png
- 各ポジションに固有の初期位置を設定

### 5. 新しい作戦システム（match.js完全書き換え） ✅
#### パス
- 「誰が」「誰に」をポジション名で指定

#### ドリブル
- **方向選択**:
  - 敵に向かって
  - 敵から逃げる様に反対方向へ
  - ゴールに対して右へ真っ直ぐ
  - ゴールに対して左へ真っ直ぐ

- **距離選択**:
  - 短距離 (1秒、10マス)
  - 中距離 (3秒、30マス)
  - 長距離 (5秒、50マス)

- **次の行動**:
  - 反対方向に中距離ドリブル
  - 誰にパス
  - コーナーめがけて丁寧にシュート
  - とにかくど真ん中に最強シュート

#### シュート
- **コーナーめがけて丁寧にシュート**: 精度1.2倍、威力0.9倍
- **とにかくど真ん中に最強シュート**: 精度0.8倍、威力1.3倍

### 6. 試合ルール ✅
- ズッキュン中学の攻撃のみをプレイ
- ズッキュン中学がシュート成功 → 1点獲得、リスタート
- 相手がボールを奪取 → 相手に1点、リスタート
- 5点先取で勝利
- 相手が5点先取でゲームオーバー

## 完了した変更（続き）

### 7. 作戦立案UIの再設計 ✅
- screens.jsのrenderMatchSetupScreen関数を完全書き換え
- ポジション名ベースの新しいUI
  - パス: 「誰が」→「誰に」の選択
  - ドリブル: 方向選択→距離選択→次の行動選択
  - シュート: シュートタイプ選択
- 段階的な選択フロー実装
- ポジション選択ドロップダウン（LW, RW, CB, LB, RB, P）

### 8. 試合画面のポジション表示 ✅
- renderMatchScreen関数の更新完了
- ポジション名ラベル表示（LW, RW, CB, etc.）
- 新しいプレイヤー配置
- Object.entries()を使用したポジションマップ対応
- getBallPosition()メソッド統合

### 9. 日次セーブシステム ✅
- メイン画面に「手動セーブ」ボタン追加
- 上書き保存の確認ダイアログ
- 自動セーブは既存機能として継続
- セーブ成功/失敗の通知

## 技術詳細

### match.jsの主な変更点
- Player classをポジションベースに変更
- MatchSimulatorを完全書き換え
- 新しいタクティクスシステムの実装
- ポジションマップ（players[position]形式）

### config.jsの追加設定
- POSITIONS: プレイヤーポジション定義
- OPPONENT_POSITIONS: 相手ポジション定義
- ACTION_CONFIG: 新しい作戦パラメータ

### gameState.jsの変更
- restPenaltyPending フラグ追加
- advanceDay()での自動ペナルティ適用

## 次のステップ

1. screens.jsの作戦UIを完全に書き換え
2. renderMatchScreen()の表示を更新
3. 日次セーブシステムの実装
4. 全体テストとバグ修正

## 注意事項

- 既存のセーブデータとは**互換性がありません**
- 新しいゲームを開始する必要があります
- エースシステムもポジションインデックスベースに変更されました
